@model ContractMonthlyClaimSystem.ViewModels.CoordinatorDashboardVM

@{
    Layout = "~/Views/Shared/CoordinatorLayout.cshtml";
    ViewData["Title"] = "Coordinator Dashboard";
}

<h2>All Submitted Claims</h2>

@if (TempData["SuccessMessage"] != null)
{
    <div class="alert alert-success">@TempData["SuccessMessage"]</div>
}
@if (TempData["ErrorMessage"] != null)
{
    <div class="alert alert-danger">@TempData["ErrorMessage"]</div>
}

<div class="d-flex flex-wrap align-items-center gap-2 mb-3">
    <span class="badge bg-warning">Pending: @Model.TotalPending</span>
    <span class="badge bg-info">Verified: @Model.TotalVerified</span>
    <span class="badge bg-success">Approved: @Model.TotalApproved</span>
    <span class="badge bg-danger">Rejected: @Model.TotalRejected</span>

    <a asp-action="AutoVerify" class="btn btn-sm btn-primary ms-3">Auto-Verify All Pending</a>
</div>

@* ======================= PENDING CLAIMS ======================= *@
<h4>Pending Claims</h4>
<div class="row row-cols-1 row-cols-md-2 g-4 mb-4">
    @if (Model.PendingClaims?.Any() != true)
    {
        <div class="col-12">
            <div class="alert alert-secondary">No pending claims.</div>
        </div>
    }
    else
    {
        foreach (var claim in Model.PendingClaims)
        {
            var progressColor = "bg-warning";
            <div class="col">
                <div class="card mb-3 shadow-sm">
                    <div class="card-header @(progressColor) text-white">
                        @claim.Title - <strong>@claim.Status</strong>
                    </div>
                    <div class="card-body">
                        <h6 class="card-subtitle mb-2 text-muted">Lecturer Profile</h6>
                        <p>
                            <strong>Name:</strong> @(claim.FullName ?? "Unknown")<br />
                            <strong>Employee ID:</strong> @claim.EmployeeID<br />
                            <strong>Year Level:</strong> @claim.YearLevel<br />
                            <strong>Qualification:</strong> @claim.QualificationName (@claim.QualificationCode)<br />
                            <strong>Faculty:</strong> @claim.Faculty
                        </p>

                        <h6 class="card-subtitle mb-2 text-muted">Module Information</h6>
                        <p>
                            <strong>Module Name:</strong> @claim.ModuleName<br />
                            <strong>Module Code:</strong> @claim.ModuleCode
                        </p>

                        <h6 class="card-subtitle mb-2 text-muted">Claim Details</h6>
                        <p>
                            <strong>Hours Worked:</strong> @claim.HoursWorked<br />
                            <strong>Hourly Rate:</strong> @claim.HourlyRate.ToString("C")<br />
                            <strong>Total Amount:</strong> @claim.TotalAmount.ToString("C")<br />
                            <strong>Submitted On:</strong> @claim.DateSubmitted.ToString("dd MMM yyyy")<br />
                            <strong>Supporting Document:</strong>
                            @if (!string.IsNullOrEmpty(claim.FilePath))
                            {
                                <a href="@claim.FilePath" target="_blank" class="btn btn-sm btn-info">View</a>
                            }
                            else
                            {
                                <span class="text-muted">No file</span>
                            }
                        </p>
                    </div>
                    <div class="card-footer text-end">
                        <a class="btn btn-success btn-sm" asp-action="Verify" asp-route-id="@claim.Id">Verify</a>
                        <a class="btn btn-danger btn-sm" asp-action="Reject" asp-route-id="@claim.Id">Reject</a>
                    </div>
                </div>
            </div>
        }
    }
</div>

@* ======================= VERIFIED CLAIMS ======================= *@
<h4>Verified Claims</h4>
<div class="row row-cols-1 row-cols-md-2 g-4 mb-4">
    @if (Model.VerifiedClaims?.Any() != true)
    {
        <div class="col-12"><div class="alert alert-secondary">No verified claims.</div></div>
    }
    else
    {
        foreach (var claim in Model.VerifiedClaims)
        {
            var progressColor = "bg-info";
            <div class="col">
                <div class="card mb-3 shadow-sm">
                    <div class="card-header @(progressColor) text-white">
                        @claim.Title - <strong>@claim.Status</strong>
                    </div>
                    <div class="card-body">
                        <h6 class="card-subtitle mb-2 text-muted">Lecturer Profile</h6>
                        <p>
                            <strong>Name:</strong> @(claim.FullName ?? "Unknown")<br />
                            <strong>Employee ID:</strong> @claim.EmployeeID<br />
                            <strong>Year Level:</strong> @claim.YearLevel<br />
                            <strong>Qualification:</strong> @claim.QualificationName (@claim.QualificationCode)<br />
                            <strong>Faculty:</strong> @claim.Faculty
                        </p>

                        <h6 class="card-subtitle mb-2 text-muted">Module Information</h6>
                        <p>
                            <strong>Module Name:</strong> @claim.ModuleName<br />
                            <strong>Module Code:</strong> @claim.ModuleCode
                        </p>

                        <h6 class="card-subtitle mb-2 text-muted">Claim Details</h6>
                        <p>
                            <strong>Total Amount:</strong> @claim.TotalAmount.ToString("C")<br />
                            <strong>Submitted On:</strong> @claim.DateSubmitted.ToString("dd MMM yyyy")
                        </p>
                    </div>
                </div>
            </div>
        }
    }
</div>

@* ======================= APPROVED CLAIMS ======================= *@
<h4>Approved Claims</h4>
<div class="row row-cols-1 row-cols-md-2 g-4 mb-4">
    @if (Model.ApprovedClaims?.Any() != true)
    {
        <div class="col-12"><div class="alert alert-secondary">No approved claims.</div></div>
    }
    else
    {
        foreach (var claim in Model.ApprovedClaims)
        {
            var progressColor = "bg-success";
            <div class="col">
                <div class="card mb-3 shadow-sm">
                    <div class="card-header @(progressColor) text-white">
                        @claim.Title - <strong>@claim.Status</strong>
                    </div>
                    <div class="card-body">
                        <h6 class="card-subtitle mb-2 text-muted">Lecturer Profile</h6>
                        <p>
                            <strong>Name:</strong> @(claim.FullName ?? "Unknown")<br />
                            <strong>Employee ID:</strong> @claim.EmployeeID<br />
                            <strong>Year Level:</strong> @claim.YearLevel<br />
                            <strong>Qualification:</strong> @claim.QualificationName (@claim.QualificationCode)<br />
                            <strong>Faculty:</strong> @claim.Faculty
                        </p>

                        <h6 class="card-subtitle mb-2 text-muted">Module Information</h6>
                        <p>
                            <strong>Module Name:</strong> @claim.ModuleName<br />
                            <strong>Module Code:</strong> @claim.ModuleCode
                        </p>

                        <h6 class="card-subtitle mb-2 text-muted">Claim Details</h6>
                        <p>
                            <strong>Total Amount:</strong> @claim.TotalAmount.ToString("C")<br />
                            <strong>Submitted On:</strong> @claim.DateSubmitted.ToString("dd MMM yyyy")
                        </p>
                    </div>
                </div>
            </div>
        }
    }
</div>

@* ======================= REJECTED CLAIMS ======================= *@
<h4>Rejected Claims</h4>
<div class="row row-cols-1 row-cols-md-2 g-4 mb-4">
    @if (Model.RejectedClaims?.Any() != true)
    {
        <div class="col-12"><div class="alert alert-secondary">No rejected claims.</div></div>
    }
    else
    {
        foreach (var claim in Model.RejectedClaims)
        {
            var progressColor = "bg-danger";
            <div class="col">
                <div class="card mb-3 shadow-sm">
                    <div class="card-header @(progressColor) text-white">
                        @claim.Title - <strong>@claim.Status</strong>
                    </div>
                    <div class="card-body">
                        <h6 class="card-subtitle mb-2 text-muted">Lecturer Profile</h6>
                        <p>
                            <strong>Name:</strong> @(claim.FullName ?? "Unknown")<br />
                            <strong>Employee ID:</strong> @claim.EmployeeID<br />
                            <strong>Year Level:</strong> @claim.YearLevel<br />
                            <strong>Qualification:</strong> @claim.QualificationName (@claim.QualificationCode)<br />
                            <strong>Faculty:</strong> @claim.Faculty
                        </p>

                        <h6 class="card-subtitle mb-2 text-muted">Module Information</h6>
                        <p>
                            <strong>Module Name:</strong> @claim.ModuleName<br />
                            <strong>Module Code:</strong> @claim.ModuleCode
                        </p>

                        <h6 class="card-subtitle mb-2 text-muted">Claim Details</h6>
                        <p>
                            <strong>Total Amount:</strong> @claim.TotalAmount.ToString("C")<br />
                            <strong>Submitted On:</strong> @claim.DateSubmitted.ToString("dd MMM yyyy")
                        </p>
                    </div>
                </div>
            </div>
        }
    }
</div>
